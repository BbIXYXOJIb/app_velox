# app_velox
Тестовое задание. Асинхронная очередь на ресайз картинок

## Использованные технологии
- Django
- Redis (Django Q)
- PostgreSQL

## Покрытие тестами
Полное покрытие тестами, для наглядности посмотрите сгенерированный отчет в htmlcov/index.html

## Обоснование решений

### Почему Django?
Django -- это шикарное решение для быстрой разработки.
По быстродействию он вряд ли сильно уступает асинхронным фреймворкам, а по скорости разработки обгоняет всех. 
За:
- Быстрая разработка
- Много инструментов от сообщества
Против:
- Возможно не самый быстрый

### Почему Django Q и Redis?
Django Q довольно простой и идеально решает нужную задачу, Celery слишком громоздкая штука.
Redis быстрый и [не теряет таски](http://oldblog.antirez.com/post/redis-persistence-demystified.html)

### Почему PostgreSQL?
Во-первых, лучше всего работает с ORM Django.
Во-вторых, лучше всех предлагаемых заданием технологий:
- Многопоточна, в отличие от SQLite
- Быстрее MongoDB при работе с таблицами
- Не потеряет все данные как Redis при перезагрузке или другом инциденте.

## API
POST /api/resize-task
Формат данных
```
{
    "target_width": null,
    "target_height": null,
    "img": null
}
```
Парсит applicaton/json, application/x-www-form-urlencoded, application/form-data

GET /api/resize-task/<UUID>
Возвращает только статус, если обработка еще в процессе. Возвращает статус и ссылку на картинку, если обработка завершена.

## Как запустить
В settings.py посмотреть какие переменные окружения необходимо выставить (данные для подключения к PostgreSQL и Redis).
`python3 manage.py migrate`
Перед запуском самого сервера запускаем асинхронную очередь `python3 manage.py qcluster`
